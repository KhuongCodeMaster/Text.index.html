<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thông Tin Game</title>
    <style>
        /* Các style như trước đây */
    </style>
</head>
<body>
    <div class="navbar">
        <span>Thông Tin Game</span>
        <div>
            <a href="index.html">Trang Chủ</a>
            <a href="register.html">Đăng Ký</a>
            <a href="login.html">Đăng Nhập</a>
            <a href="#" id="logout" style="display: none;">Đăng Xuất</a>
        </div>
    </div>

    <div class="content">
        <h1 id="game-title">Eliza's Secret Potion</h1>
        <img id="game-image" src="Castle.png" alt="Ảnh Game Chính">
        <p id="game-description">
            Eliza là một cô phù thủy trẻ, khám phá một công thức bí ẩn gọi là Secret Potion. Trong hành trình, bạn sẽ vào vai nhân vật nam da đen 🙍🏿‍♂️ và bạn sẽ cố gắng nâng cấp công thức chế tạo Secret Potion và để làm gì thì tự biết đi nhá 🌚
        </p>

        <h2>Show Một Chút Ảnh 🌚:</h2>
        <div class="image-grid">
            <a href="#img1"><img id="img1" src="悪夢.png" alt="悪夢"></a>
            <a href="#img2"><img id="img2" src="C-2 全身.png" alt="C-2 全身"></a>
            <a href="#img3"><img id="img3" src="F-1 全体.png" alt="F-1 全体"></a>
            <a href="#img4"><img id="img4" src="D-11 深く.png" alt="D-11 深く"></a>
            <a href="#img5"><img id="img5" src="B-7 中出し.png" alt="B-7 中出し"></a>
            <a href="#img6"><img id="img6" src="E-8 深い.png" alt="E-8 深い"></a>
            <a href="#img7"><img id="img7" src="J-14 中出し後.png" alt="J-14 中出し後"></a>
        </div>

        <h2 style="margin-top: 30px;">Link Tải Game:</h2>
        <a href="#" class="button" onclick="downloadGame(event)">Tải Game</a>

        <div class="comment-section">
            <h2>Bình Luận:</h2>
            <textarea id="comment-input" placeholder="Nhập bình luận của bạn"></textarea><br>
            <button onclick="postComment()">Đăng Bình Luận</button>
        </div>

        <div class="comment-list" id="comment-list">
            <!-- Bình luận sẽ được hiển thị ở đây -->
        </div>
    </div>

    <!-- Lightbox -->
    <div id="lightbox" class="lightbox">
        <img src="" alt="Large View" id="lightbox-img">
    </div>

    <script>
        // Kiểm tra trạng thái đăng nhập và hiển thị tên người dùng
        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem("isLoggedIn") === "true"; // Kiểm tra xem đã đăng nhập hay chưa
            const username = localStorage.getItem("username");

            if (isLoggedIn && username) {
                // Nếu đã đăng nhập, hiển thị tên và nút đăng xuất
                document.getElementById("logout").style.display = "inline-block"; // Hiển thị nút đăng xuất
                document.querySelector(".navbar").innerHTML += `<span>Chào, ${username}!</span>`;
            } else {
                // Nếu chưa đăng nhập, ẩn nút đăng xuất và không hiển thị tên
                document.getElementById("logout").style.display = "none"; // Ẩn nút đăng xuất
            }
        }

        // Xử lý tải game
        function downloadGame(event) {
            event.preventDefault();
            const isLoggedIn = localStorage.getItem("isLoggedIn") === "true";

            if (isLoggedIn) {
                alert("Bắt đầu tải game!");
            } else {
                alert("Bạn cần đăng nhập để tải game này!");
                window.location.href = "login.html"; // Chuyển hướng tới trang đăng nhập nếu chưa đăng nhập
            }
        }

        // Đăng xuất
        document.getElementById("logout").addEventListener("click", () => {
            localStorage.removeItem("isLoggedIn");
            localStorage.removeItem("username");
            alert("Đăng xuất thành công!");
            window.location.reload(); // Tải lại trang khi đăng xuất
        });

        // Đăng bình luận
        function postComment() {
            const commentInput = document.getElementById("comment-input");
            const commentList = document.getElementById("comment-list");
            const username = localStorage.getItem("username") || "Khách";

            if (commentInput.value.trim() === "") {
                alert("Vui lòng nhập nội dung bình luận!");
                return;
            }

            const comment = {
                username: username,
                content: commentInput.value,
                time: new Date().toLocaleString(),
            };

            // Lưu và hiển thị bình luận
            const existingComments = JSON.parse(localStorage.getItem("comments")) || [];
            existingComments.push(comment);
            localStorage.setItem("comments", JSON.stringify(existingComments));
            addCommentToUI(comment);
            commentInput.value = "";
        }

        // Hiển thị bình luận lên giao diện
        function addCommentToUI(comment) {
            const commentList = document.getElementById("comment-list");
            const commentElement = document.createElement("div");
            commentElement.classList.add("comment-item");
            commentElement.innerHTML = `
                <strong>${comment.username}</strong> <span>${comment.time}</span>
                <p>${comment.content}</p>
            `;
            commentList.appendChild(commentElement);
        }

        // Hiển thị tất cả bình luận khi tải trang
        window.onload = function() {
            const savedComments = JSON.parse(localStorage.getItem("comments")) || [];
            savedComments.forEach(comment => {
                addCommentToUI(comment);
            });

            checkLoginStatus(); // Kiểm tra đăng nhập khi trang được tải
        }
    </script>
</body>
</html>
